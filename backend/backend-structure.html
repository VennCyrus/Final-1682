<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>C·∫•u tr√∫c Backend - Resume Builder</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #e0e0e0;
      line-height: 1.6;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: rgba(30, 30, 40, 0.95);
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #667eea 0%, #f093fb 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-align: center;
    }

    .subtitle {
      text-align: center;
      color: #b0b0b0;
      margin-bottom: 40px;
      font-size: 1.1em;
    }

    .section {
      background: rgba(40, 40, 55, 0.6);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 25px;
      border-left: 4px solid #667eea;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .section:hover {
      transform: translateX(5px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    }

    h2 {
      font-size: 1.8em;
      margin-bottom: 15px;
      color: #f093fb;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    h2::before {
      content: "üìÅ";
      font-size: 1.2em;
    }

    h3 {
      font-size: 1.3em;
      margin-top: 20px;
      margin-bottom: 10px;
      color: #a78bfa;
    }

    .file-item {
      background: rgba(50, 50, 65, 0.5);
      padding: 15px;
      margin: 10px 0;
      border-radius: 10px;
      border-left: 3px solid #8b5cf6;
    }

    .file-name {
      font-weight: bold;
      color: #fbbf24;
      font-family: 'Courier New', monospace;
      font-size: 1.1em;
      margin-bottom: 8px;
    }

    .file-path {
      color: #60a5fa;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      margin-bottom: 5px;
    }

    .file-description {
      color: #d1d5db;
      margin-top: 8px;
      line-height: 1.7;
    }

    .code-block {
      background: rgba(20, 20, 30, 0.8);
      padding: 12px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      color: #34d399;
      margin: 10px 0;
      overflow-x: auto;
      border: 1px solid rgba(102, 126, 234, 0.3);
    }

    .highlight {
      color: #fbbf24;
      font-weight: bold;
    }

    .note {
      background: rgba(59, 130, 246, 0.2);
      border-left: 4px solid #3b82f6;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      color: #bfdbfe;
    }

    ul {
      list-style: none;
      padding-left: 0;
    }

    li {
      margin: 8px 0;
      padding-left: 25px;
      position: relative;
    }

    li::before {
      content: "‚ñ∏";
      position: absolute;
      left: 0;
      color: #8b5cf6;
      font-weight: bold;
    }

    .flow-diagram {
      background: rgba(20, 20, 30, 0.8);
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border: 2px dashed rgba(102, 126, 234, 0.5);
    }

    .arrow {
      text-align: center;
      color: #8b5cf6;
      font-size: 1.5em;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìö C·∫•u tr√∫c Backend - Resume Builder</h1>
    <p class="subtitle">Gi·∫£i th√≠ch chi ti·∫øt t·ª´ng folder v√† file trong d·ª± √°n backend</p>

    <!-- Root Files -->
    <div class="section">
      <h2>üìÑ Root Files (Th∆∞ m·ª•c g·ªëc)</h2>
      
      <div class="file-item">
        <div class="file-name">server.js</div>
        <div class="file-path">backend/server.js (d√≤ng 1-50)</div>
        <div class="file-description">
          <strong>File kh·ªüi ƒë·ªông ch√≠nh c·ªßa ·ª©ng d·ª•ng:</strong>
          <ul>
            <li>Import Express, CORS, dotenv, k·∫øt n·ªëi database</li>
            <li>Import c√°c router: userRouter, adminRouter, resumeRouter</li>
            <li>Kh·ªüi t·∫°o Express app, c·∫•u h√¨nh middleware (CORS, JSON parser)</li>
            <li>K·∫øt n·ªëi MongoDB qua <code>connectDB()</code></li>
            <li>ƒêƒÉng k√Ω routes: <code>/api/auth</code>, <code>/api/resume</code>, <code>/api/admin</code></li>
            <li>C·∫•u h√¨nh static folder <code>/uploads</code> ƒë·ªÉ serve ·∫£nh</li>
            <li>L·∫Øng nghe tr√™n PORT (m·∫∑c ƒë·ªãnh 4000)</li>
          </ul>
        </div>
      </div>

      <div class="file-item">
        <div class="file-name">package.json</div>
        <div class="file-path">backend/package.json</div>
        <div class="file-description">
          <strong>File c·∫•u h√¨nh d·ª± √°n v√† dependencies:</strong>
          <ul>
            <li><span class="highlight">Dependencies:</span> express, mongoose, jsonwebtoken, bcryptjs, multer, cors, dotenv, google-auth-library</li>
            <li><span class="highlight">Scripts:</span> <code>npm start</code> ch·∫°y nodemon ƒë·ªÉ auto-reload</li>
            <li><span class="highlight">Type:</span> module (ES6 imports)</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Config Folder -->
    <div class="section">
      <h2>‚öôÔ∏è config/</h2>
      <p class="file-description">Th∆∞ m·ª•c ch·ª©a c√°c file c·∫•u h√¨nh h·ªá th·ªëng</p>
      
      <div class="file-item">
        <div class="file-name">db.js</div>
        <div class="file-path">backend/config/db.js (d√≤ng 1-8)</div>
        <div class="file-description">
          <strong>K·∫øt n·ªëi MongoDB:</strong>
          <ul>
            <li>H√†m <code>connectDB()</code> k·∫øt n·ªëi t·ªõi MongoDB qua <code>MONGO_URL</code> t·ª´ .env</li>
            <li>S·ª≠ d·ª•ng Mongoose ƒë·ªÉ qu·∫£n l√Ω k·∫øt n·ªëi</li>
            <li>Log th√¥ng b√°o khi k·∫øt n·ªëi th√†nh c√¥ng</li>
            <li>ƒê∆∞·ª£c g·ªçi trong <code>server.js</code> khi kh·ªüi ƒë·ªông</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Models Folder -->
    <div class="section">
      <h2>üóÑÔ∏è models/</h2>
      <p class="file-description">Th∆∞ m·ª•c ƒë·ªãnh nghƒ©a Schema v√† Model cho MongoDB (Mongoose)</p>
      
      <div class="file-item">
        <div class="file-name">userModel.js</div>
        <div class="file-path">backend/models/userModel.js (d√≤ng 1-35)</div>
        <div class="file-description">
          <strong>Schema cho User:</strong>
          <ul>
            <li><span class="highlight">name:</span> String, required</li>
            <li><span class="highlight">email:</span> String, required, unique</li>
            <li><span class="highlight">password:</span> String, required (ch·ªâ khi kh√¥ng c√≥ googleId)</li>
            <li><span class="highlight">googleId:</span> String, sparse (cho Google OAuth)</li>
            <li><span class="highlight">picture:</span> String (·∫£nh ƒë·∫°i di·ªán t·ª´ Google)</li>
            <li><span class="highlight">role:</span> enum ['user', 'admin'], default 'user'</li>
            <li><span class="highlight">timestamps:</span> t·ª± ƒë·ªông th√™m createdAt, updatedAt</li>
          </ul>
        </div>
      </div>

      <div class="file-item">
        <div class="file-name">resumeModel.js</div>
        <div class="file-path">backend/models/resumeModel.js (d√≤ng 1-91)</div>
        <div class="file-description">
          <strong>Schema cho Resume (CV):</strong>
          <ul>
            <li><span class="highlight">userId:</span> ObjectId, ref User, required (li√™n k·∫øt v·ªõi user)</li>
            <li><span class="highlight">title:</span> String, required</li>
            <li><span class="highlight">thumbnailLink:</span> String (link ·∫£nh thumbnail)</li>
            <li><span class="highlight">template:</span> Object {theme, colorPalette}</li>
            <li><span class="highlight">profileInfo:</span> Object {profilePreviewUrl, fullName, designation, summary}</li>
            <li><span class="highlight">contactInfo:</span> Object {email, phone, location, linkedin, github, website}</li>
            <li><span class="highlight">workExperience:</span> Array [{company, role, startDate, endDate, description}]</li>
            <li><span class="highlight">education:</span> Array [{degree, institution, startDate, endDate}]</li>
            <li><span class="highlight">skills:</span> Array [{name, progress}]</li>
            <li><span class="highlight">projects:</span> Array [{title, description, github, liveDemo}]</li>
            <li><span class="highlight">certifications:</span> Array [{title, issuer, year}]</li>
            <li><span class="highlight">languages:</span> Array [{name, progress}]</li>
            <li><span class="highlight">interests:</span> Array[String]</li>
            <li><span class="highlight">timestamps:</span> createdAt, updatedAt</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Middleware Folder -->
    <div class="section">
      <h2>üõ°Ô∏è middleware/</h2>
      <p class="file-description">Th∆∞ m·ª•c ch·ª©a c√°c middleware x·ª≠ l√Ω request tr∆∞·ªõc khi v√†o controller</p>
      
      <div class="file-item">
        <div class="file-name">authMiddleware.js</div>
        <div class="file-path">backend/middleware/authMiddleware.js (d√≤ng 1-22)</div>
        <div class="file-description">
          <strong>Middleware x√°c th·ª±c JWT Token:</strong>
          <ul>
            <li>H√†m <code>protect</code> ki·ªÉm tra token t·ª´ header <code>Authorization: Bearer &lt;token&gt;</code></li>
            <li>Verify token b·∫±ng <code>jwt.verify()</code> v·ªõi <code>JWT_SECRET</code></li>
            <li>L·∫•y userId t·ª´ decoded token, t√¨m user trong DB</li>
            <li>G·∫Øn user v√†o <code>req.user</code> ƒë·ªÉ controller s·ª≠ d·ª•ng</li>
            <li>Tr·∫£ 401 n·∫øu kh√¥ng c√≥ token ho·∫∑c token kh√¥ng h·ª£p l·ªá</li>
            <li>ƒê∆∞·ª£c d√πng trong c√°c route c·∫ßn ƒëƒÉng nh·∫≠p</li>
          </ul>
        </div>
      </div>

      <div class="file-item">
        <div class="file-name">adminMiddleware.js</div>
        <div class="file-path">backend/middleware/adminMiddleware.js (d√≤ng 1-22)</div>
        <div class="file-description">
          <strong>Middleware ki·ªÉm tra quy·ªÅn Admin:</strong>
          <ul>
            <li>H√†m <code>admin</code> ki·ªÉm tra <code>req.user.role === 'admin'</code></li>
            <li>Ph·∫£i ƒë·∫∑t sau <code>protect</code> (v√¨ c·∫ßn <code>req.user</code>)</li>
            <li>Tr·∫£ 403 n·∫øu kh√¥ng ph·∫£i admin</li>
            <li>ƒê∆∞·ª£c d√πng cho c√°c route ch·ªâ admin m·ªõi truy c·∫≠p ƒë∆∞·ª£c</li>
          </ul>
        </div>
      </div>

      <div class="file-item">
        <div class="file-name">uploadMiddleware.js</div>
        <div class="file-path">backend/middleware/uploadMiddleware.js (d√≤ng 1-23)</div>
        <div class="file-description">
          <strong>Middleware x·ª≠ l√Ω upload file (Multer):</strong>
          <ul>
            <li>C·∫•u h√¨nh <code>multer.diskStorage</code> l∆∞u file v√†o folder <code>uploads/</code></li>
            <li>ƒê·∫∑t t√™n file: <code>Date.now()-originalname</code> (tr√°nh tr√πng)</li>
            <li><code>fileFilter</code> ch·ªâ cho ph√©p: image/jpeg, image/png, image/jpg</li>
            <li>Export instance multer ƒë·ªÉ d√πng trong controller</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Controllers Folder -->
    <div class="section">
      <h2>üéÆ controllers/</h2>
      <p class="file-description">Th∆∞ m·ª•c ch·ª©a logic x·ª≠ l√Ω business cho t·ª´ng module</p>
      
      <div class="file-item">
        <div class="file-name">userController.js</div>
        <div class="file-path">backend/controllers/userController.js (d√≤ng 1-163)</div>
        <div class="file-description">
          <strong>Controller x·ª≠ l√Ω User/Auth:</strong>
          <ul>
            <li><span class="highlight">generateToken(userId):</span> T·∫°o JWT token v·ªõi expiresIn 7d</li>
            <li><span class="highlight">registerUser:</span> ƒêƒÉng k√Ω user m·ªõi (hash password, t·∫°o user, tr·∫£ token)</li>
            <li><span class="highlight">loginUser:</span> ƒêƒÉng nh·∫≠p (t√¨m user, verify password b·∫±ng bcrypt, tr·∫£ token)</li>
            <li><span class="highlight">googleLogin:</span> X√°c th·ª±c Google OAuth, t·∫°o/update user, tr·∫£ token</li>
            <li><span class="highlight">getUserProfile:</span> L·∫•y th√¥ng tin user (d√πng <code>protect</code> middleware)</li>
          </ul>
        </div>
      </div>

      <div class="file-item">
        <div class="file-name">resumeController.js</div>
        <div class="file-path">backend/controllers/resumeController.js (d√≤ng 1-201)</div>
        <div class="file-description">
          <strong>Controller x·ª≠ l√Ω Resume (CRUD):</strong>
          <ul>
            <li><span class="highlight">createResume:</span> T·∫°o resume m·ªõi v·ªõi d·ªØ li·ªáu m·∫∑c ƒë·ªãnh, g·∫Øn userId</li>
            <li><span class="highlight">getUserResume:</span> L·∫•y t·∫•t c·∫£ resume c·ªßa user hi·ªán t·∫°i, sort theo createdAt</li>
            <li><span class="highlight">getResumeById:</span> L·∫•y 1 resume theo ID (ki·ªÉm tra userId ƒë·ªÉ b·∫£o m·∫≠t)</li>
            <li><span class="highlight">updateResume:</span> T√¨m resume, merge d·ªØ li·ªáu m·ªõi, save</li>
            <li><span class="highlight">deleteResume:</span> X√≥a resume + x√≥a file thumbnail/profileImage trong uploads/</li>
          </ul>
        </div>
      </div>

      <div class="file-item">
        <div class="file-name">uploadImages.js</div>
        <div class="file-path">backend/controllers/uploadImages.js (d√≤ng 1-57)</div>
        <div class="file-description">
          <strong>Controller x·ª≠ l√Ω upload ·∫£nh:</strong>
          <ul>
            <li><span class="highlight">uploadResumeImages:</span> Upload thumbnail v√† profileImage</li>
            <li>S·ª≠ d·ª•ng multer middleware ƒë·ªÉ nh·∫≠n file</li>
            <li>X√≥a file c≈© n·∫øu c√≥, l∆∞u file m·ªõi, c·∫≠p nh·∫≠t link v√†o resume</li>
            <li>Tr·∫£ v·ªÅ <code>thumbnailLink</code> v√† <code>profilePreviewUrl</code></li>
          </ul>
        </div>
      </div>

      <div class="file-item">
        <div class="file-name">adminController.js</div>
        <div class="file-path">backend/controllers/adminController.js (d√≤ng 1-71)</div>
        <div class="file-description">
          <strong>Controller x·ª≠ l√Ω Admin Dashboard:</strong>
          <ul>
            <li><span class="highlight">getAdminStats:</span> Th·ªëng k√™ t·ªïng quan</li>
            <li>ƒê·∫øm t·ªïng users, t·ªïng resumes</li>
            <li>Aggregate resumes theo ng√†y (30 ng√†y g·∫ßn nh·∫•t)</li>
            <li>Fill missing days v·ªõi count = 0</li>
            <li>Tr·∫£ v·ªÅ data cho bi·ªÉu ƒë·ªì dashboard</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Routes Folder -->
    <div class="section">
      <h2>üõ£Ô∏è routes/</h2>
      <p class="file-description">Th∆∞ m·ª•c ƒë·ªãnh nghƒ©a c√°c route v√† g·∫Øn controller t∆∞∆°ng ·ª©ng</p>
      
      <div class="file-item">
        <div class="file-name">userRoutes.js</div>
        <div class="file-path">backend/routes/userRoutes.js (d√≤ng 1-13)</div>
        <div class="file-description">
          <strong>Routes cho Authentication:</strong>
          <div class="code-block">
POST   /api/auth/register      ‚Üí registerUser
POST   /api/auth/login          ‚Üí loginUser
POST   /api/auth/google-login   ‚Üí googleLogin
GET    /api/auth/profile        ‚Üí getUserProfile (protect)
          </div>
        </div>
      </div>

      <div class="file-item">
        <div class="file-name">resumeRoutes.js</div>
        <div class="file-path">backend/routes/resumeRoutes.js (d√≤ng 1-24)</div>
        <div class="file-description">
          <strong>Routes cho Resume:</strong>
          <div class="code-block">
POST   /api/resume              ‚Üí createResume (protect)
GET    /api/resume              ‚Üí getUserResume (protect)
GET    /api/resume/:id          ‚Üí getResumeById (protect)
PUT    /api/resume/:id          ‚Üí updateResume (protect)
PUT    /api/resume/:id/upload-images ‚Üí uploadResumeImages (protect)
DELETE /api/resume/:id          ‚Üí deleteResume (protect)
          </div>
        </div>
      </div>

      <div class="file-item">
        <div class="file-name">adminRoutes.js</div>
        <div class="file-path">backend/routes/adminRoutes.js (d√≤ng 1-11)</div>
        <div class="file-description">
          <strong>Routes cho Admin:</strong>
          <div class="code-block">
GET    /api/admin/stats         ‚Üí getAdminStats (protect, admin)
          </div>
          <div class="note">
            <strong>L∆∞u √Ω:</strong> Route n√†y y√™u c·∫ßu c·∫£ <code>protect</code> (ƒëƒÉng nh·∫≠p) v√† <code>admin</code> (quy·ªÅn admin)
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts Folder -->
    <div class="section">
      <h2>üîß scripts/</h2>
      <p class="file-description">Th∆∞ m·ª•c ch·ª©a c√°c script ti·ªán √≠ch, kh√¥ng ph·∫£i ph·∫ßn c·ªßa API</p>
      
      <div class="file-item">
        <div class="file-name">setAdmin.js</div>
        <div class="file-path">backend/scripts/setAdmin.js (d√≤ng 1-72)</div>
        <div class="file-description">
          <strong>Script thi·∫øt l·∫≠p user l√†m admin:</strong>
          <ul>
            <li>K·∫øt n·ªëi MongoDB</li>
            <li>T·∫°o ho·∫∑c update user v·ªõi role = 'admin'</li>
            <li>H·ªó tr·ª£ c·∫£ user th∆∞·ªùng (hash password) v√† Google user (googleId)</li>
            <li>Ch·∫°y ƒë·ªôc l·∫≠p: <code>node scripts/setAdmin.js</code></li>
            <li>D√πng ƒë·ªÉ setup admin ban ƒë·∫ßu ho·∫∑c th√™m admin m·ªõi</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Flow Diagram -->
    <div class="section">
      <h2>üîÑ Lu·ªìng x·ª≠ l√Ω Request</h2>
      <div class="flow-diagram">
        <div style="text-align: center; color: #fbbf24; font-weight: bold; margin-bottom: 15px;">Client Request</div>
        <div class="arrow">‚Üì</div>
        <div style="text-align: center; color: #8b5cf6; font-weight: bold;">server.js (Express App)</div>
        <div class="arrow">‚Üì</div>
        <div style="text-align: center; color: #60a5fa; font-weight: bold;">routes/ (ƒê·ªãnh tuy·∫øn)</div>
        <div class="arrow">‚Üì</div>
        <div style="text-align: center; color: #f093fb; font-weight: bold;">middleware/ (X√°c th·ª±c, ki·ªÉm tra quy·ªÅn)</div>
        <div class="arrow">‚Üì</div>
        <div style="text-align: center; color: #34d399; font-weight: bold;">controllers/ (Logic x·ª≠ l√Ω)</div>
        <div class="arrow">‚Üì</div>
        <div style="text-align: center; color: #fbbf24; font-weight: bold;">models/ (Truy v·∫•n MongoDB)</div>
        <div class="arrow">‚Üì</div>
        <div style="text-align: center; color: #f093fb; font-weight: bold;">Response v·ªÅ Client</div>
      </div>
    </div>

    <!-- Summary -->
    <div class="section">
      <h2>üìã T√≥m t·∫Øt</h2>
      <div class="file-description">
        <ul>
          <li><strong>server.js:</strong> Entry point, kh·ªüi t·∫°o Express, ƒëƒÉng k√Ω routes</li>
          <li><strong>config/:</strong> C·∫•u h√¨nh database connection</li>
          <li><strong>models/:</strong> ƒê·ªãnh nghƒ©a Schema MongoDB (User, Resume)</li>
          <li><strong>middleware/:</strong> X√°c th·ª±c token, ki·ªÉm tra quy·ªÅn, upload file</li>
          <li><strong>controllers/:</strong> Logic x·ª≠ l√Ω business (CRUD, auth, upload, stats)</li>
          <li><strong>routes/:</strong> ƒê·ªãnh nghƒ©a endpoints v√† g·∫Øn controller</li>
          <li><strong>scripts/:</strong> Utility scripts (setAdmin)</li>
          <li><strong>uploads/:</strong> Folder l∆∞u file ·∫£nh (t·ª± ƒë·ªông t·∫°o khi upload)</li>
        </ul>
      </div>
    </div>

    <div class="note" style="margin-top: 40px;">
      <strong>üí° L∆∞u √Ω:</strong> T·∫•t c·∫£ c√°c route (tr·ª´ register/login) ƒë·ªÅu c·∫ßn middleware <code>protect</code> ƒë·ªÉ x√°c th·ª±c token. 
      Route admin c·∫ßn th√™m middleware <code>admin</code> ƒë·ªÉ ki·ªÉm tra quy·ªÅn.
    </div>
  </div>
</body>
</html>




